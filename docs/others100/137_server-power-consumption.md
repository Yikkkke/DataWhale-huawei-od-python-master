# 137 服务器耗能

## 题目描述

服务器有三种运行状态：空载、单任务、多任务，每个时间片的能耗分别为1、3、4，每个任务由起始时间片和结束时间片定义运行时间。
- 如果一个时间片只有一个任务需要执行，则服务器处于单任务状态。
- 如果一个时间片有多个任务需要执行，则服务器处于多任务状态。

给定一个任务列表，请计算出从第一个任务开始，到所有任务结束时，服务器的总能耗。

## 输入描述

一个只包含整数的二维数组：
```text
num
start0 end0
start1 end1
...
```

第1行的数字表示一个有多少个任务，后续每行包含由空格分隔的两个整数，用于确定每一个任务的起始时间片和结束时间片。任务执行时间包含起始和结束时间片，即任务执行时间是左闭右闭的。结束时间片一定大于等于起始时间片。

其中，时间片范围为[0, 1000000]，任务数范围为[1, 10000]。

## 输出描述

输出一个整数，代表服务器的总能耗。

## 示例描述

### 示例一

**输入：**
```text
2
2 5
8 9
```

**输出：**
```text
20
```

**说明：**  
- [0,1]时刻，没有任务需要执行，能耗为0
- [2,5]时刻，处于单任务状态，能耗为3 * 4 = 12
- [6,7]时刻，处于空载状态，能耗为1 * 2 = 2
- [8,9]时刻，处于单任务状态，能耗为3 * 2 = 6
共计能耗为12 + 2 + 6 = 20。

### 示例二

**输入：**
```text
3
4 8
1 6
2 9
```

**输出：**
```text
34
```

**说明：**
- [0]时刻，没有任务需要执行，能耗为0
- [1]时刻，处于单任务状态，能耗为3 * 1 = 3
- [2,8]时刻，处于多任务状态，能耗为4 * 7 = 28
- [9]时刻，处于单任务状态，能耗为3 * 1 = 3
共计能耗为3 + 28 + 3 = 34。

## 解题思路

1. 初始化时刻的任务数列表`time_powers`。
2. 遍历所有任务：
   - 获取任务起始时刻`min_time`、结束时刻`max_time`。
   - 遍历每个任务，从起始时间片到结束时间片，得到各时刻的运行任务数。
3. 遍历所有运行时刻，从起始时刻到结束时刻：
   - 空载时，时间片能耗+1
   - 单任务时，时间片能耗+3
   - 多任务时，时间片能耗+4
4. 返回服务器的总能耗。

## 解题代码

```python
import math

def solve_method(task_times):
    time_powers = [0] * 1000001
    min_time = math.inf
    max_time = -1

    for task_time in task_times:
        start_time = task_time[0]
        end_time = task_time[1]
        min_time = min(min_time, start_time)
        max_time = max(max_time, end_time)
        # 当前时刻的运行任务数
        for i in range(start_time, end_time + 1):
            time_powers[i] += 1

    result = 0
    for i in range(min_time, max_time + 1):
        p = time_powers[i]
        if p == 0:
            # 空载
            result += 1
        elif p == 1:
            # 单任务
            result += 3
        else:
            # 多任务
            result += 4

    return result


if __name__ == '__main__':
    task_times = [[2, 5], [8, 9]]
    assert solve_method(task_times) == 20

    task_times = [[4, 8], [1, 6], [2, 9]]
    assert solve_method(task_times) == 34
```