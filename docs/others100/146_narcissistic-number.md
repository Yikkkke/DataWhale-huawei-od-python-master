# 146 水仙花数

## 题目描述

所谓的水仙花数（也称为**自幂数**）是指一个`n`位的正整数，满足其各位数字的`n`次方的和等于该数本身，一例如 `153 = 1^3 + 5^3 + 3^3`，153是一个三位数。

## 输入描述

第一行输入一个整数`N`，表示`N`位的正整数`N`，取值范围是[3,7]。

第二行输入一个正整数`M`，表示需要返回第`M`个水仙花数。

若输入不合法，则返回-1。

## 输出描述

返回长度是`N`的第`M`个水仙花数，个数从0开始编号。

若`M`大于水仙花数的个数，返回最后一个水仙花数和`M`的乘积，若输入不合法返回—1。

## 示例描述

### 示例一

**输入：**

```text
3
0
```

**输出：**

```text
153
```

**说明：**  

153是第一个水仙花数。

### 示例二

**输入：**

```text
9
1
```

**输出：**

```text
-1
```

**说明：**  

`n`不满足条件（在3到7之间），无效输入返回-1。

## 解题思路

1. 检查输入是否合法，即`N`必须在3到7之间。如果不满足条件，则输出-1。
2. 初始化幂计算列表`digit_power`，`digit_power[i][j]`表示数字`i`的`j`次幂的值。
3. 遍历所有`N`位数字：
   - 计算每一个数字的幂和，如果等于自身，则存入结果列表
   - 如果已经是第`M`个，则直接返回该数字
4. 若M大于水仙花数的个数，返回最后一个水仙花数和M的乘积。   

**注：**

常见自幂数包括以下：

> [自幂数_百度百科 (baidu.com)](https://baike.baidu.com/item/自幂数?fromModule=lemma_inlink)
> 独身数（1位）共有9个: 1，2，3，4，5，6，7，8，9；
> 水仙花数（3位）共有4个：153，370，371，407；
> 四叶玫瑰数（4位）共有3个：1634，8208，9474；
> 五角星数（5位）共有3个：54748，92727，93084；
> 六合数（6位）只有1个：548834；
> 北斗七星数（7位）共有4个：1741725，4210818，9800817，9926315；
> 八仙数（8位）共有3个：24678050，24678051，88593477

## 解题代码

```python
def solve_method(N: int, M: int) -> int:
    # 检查输入是否有效
    if not (3 <= N <= 7):
        return -1

    # digit_power[i][j]表示数字i的j次幂的值
    digit_power = [[0] * (N + 1) for _ in range(10)]
    for i in range(1, 10):
        digit_power[i][0] = 1
        for j in range(1, N + 1):
            digit_power[i][j] = digit_power[i][j - 1] * i

    # 通过循环查找自幂数,注意使用 digit_power 避免重复计算
    nums = []
    start, end = 10 ** (N - 1), 10 ** N

    for num in range(start, end):
        # 保存每个数字的幂次之和
        sum_val = 0
        # 用来获取数字的每一位数
        bit = num
        while bit != 0:
            sum_val += digit_power[(bit % 10)][N]
            bit //= 10

        if sum_val == num:
            nums.append(num)

        # 如果要查找的M已经找到，提前返回
        if len(nums) == M + 1:
            return nums[-1]

    # 若M大于水仙花数的个数，返回最后一个水仙花数和M的乘积
    if M > len(nums):
        return M * nums[-1]

if __name__ == '__main__':
    assert solve_method(3, 0) == 153
    assert solve_method(9, 1) == -1
    assert solve_method(4, 0) == 1634
    assert solve_method(4, 1) == 8208
```