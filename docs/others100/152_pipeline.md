# 152 流水线

## 题目描述

一个工厂有`m`条流水线，来并行完成`n`个独立的作业，该工厂设置了一个调度系统。在安排作业时，总是优先执行处理时间最短的作业。

现给定流水线个数`m`，需要完成的作业数`n`，每个作业的处理时间分别为`t1,t2,...,tn`。请你编程计算处理完所有作业的耗时为多少？

规则如下：
- 当`n>m`时，首先处理时间短的`m`个作业进入流水线，其他的等待。
- 当某个作业完成时，依次从剩余作业中取处理时间最短的进入处理。

## 输入描述

第一行是两个整数（使用空格分隔），分别表示流水线个数`m`和作业数`n`，取值范围是0 < m,n < 100。

第二行输入`n`个整数（使用空格分隔），表示每个作业的处理时长`t1,t2...tn`， 取值范围是0 < t1,t2,...,tn < 100。

## 输出描述

输出处理完所有作业的总时长。 

## 示例描述

### 示例一

**输入：**

```text
3 5
8 4 3 2 10
```

**输出：**

```text
13
```

**说明：**

- 先安排时间为2、3、4的三个作业，第一条流水线先完成作业。
- 调度剩余时间最短的作业8，第二条流水线完成作业。
- 调度剩余时间最短的作业10。

总共耗时是两条流水线完成作业时间，时间为3+10=13。

## 解题思路

1. 将作业处理时间`job_times`按从小到大排序。
2. 初始化流水线`pipelines`的处理时间为0。
3. 遍历所有任务：
    - 找到处理时间最短的流水线。
    - 将当前作业分配给最短处理时间的流水线。
4. 返回流水线中的最大时长。    

## 解题代码

```python
def solve_method(m, n, job_times):
    # 将作业处理时间按升序排序
    job_times.sort()
    # 初始化流水线的处理时间为0
    pipelines = [0] * m

    for i in range(n):
        # 找到处理时间最短的流水线
        min_pipeline = min(pipelines)
        index = pipelines.index(min_pipeline)
        # 将当前作业分配给最短处理时间的流水线
        pipelines[index] += job_times[i]

    total_time = max(pipelines)

    return total_time


if __name__ == '__main__':
    assert solve_method(3, 5, [8, 4, 3, 2, 10]) == 13
```

