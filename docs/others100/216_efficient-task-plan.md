# 216 高效的任务规划

## 题目描述

有`n`台机器，机器的编号为1\~n，每台都需要完成一项工作，机器经过配置后都能独立完成一项工作。

假设第`i`台机器需要花`B[i]`分钟进行设置，然后开始运行`J[i]`分钟后完成任务。

现在需要选择布置工作的顺序，使得用最短得时间完成所有工作。注意，不能同时对两台机器进行配置。但配置完成的机器可以同时执行它们各自的工作。

## 输入描述

第1行表示共有`M`组任务数据，取值范围为1 < M <= 10。

每组数的第1行为一个整数，指定机器的数量`N`，取值范围为0 < N <= 1000。

随后的`N`行，每行两个整数，第1个表示`B`，取值范围为0 <= B <= 10000，第2个表示`J`，取值范围为0 <= J <= 10000。

每组数据连续输入，不会用空行分隔，各组任务单独计时。

## 输出描述

对于每组任务，输出最短完成时间。且每组的结果单独占据一行。

例如，两组任务就应该有两行输出。

## 示例描述

### 示例一

**输入：**
```text
1
1
2 2
```

**输出：**
```text
4
```

**说明：**  
输入共3行数据：
- 第1行表示只有1组任务
- 第2行表示本组任务只有1台机器
- 第3行表示本机器，配置需要2分钟，执行任务需要2分钟
所以，该组任务需要4分钟才能完成。

### 示例一

**输入：**
```text
2
2
1 1
2 2
3
1 1
2 2
3 3
```

**输出：**
```text
4
7
```

**说明：**  
第1行表示有2组任务，第2\~4行表示第1组数据，为2台机器的配置和执行信息：
- 第1台：配置1分钟，执行1分钟。
- 第2台：配置2分钟，执行2分钟。
第5\~8行表示第2组数据，为3台机器的配置和执行信息：
- 第1台：配置1分钟，执行1分钟。
- 第2台：配置2分钟，执行2分钟。
- 第3台：配置3分钟，执行3分钟。
输出共2行，分别表示：
- 第1组任务需要5分钟：先配置2号机器，再配置1号机器，执行2分钟，共5分钟。
- 第2组任务需要9分钟：先配置3号机器，再配置2号机器，最后配置1号机器，执行3分钟，共9分钟。

## 解题思路

1. 遍历每组数据：
    - 按照机器的运行时间从大到小对任务进行排列。
    - 初始化总任务时间和还需要等待的执行时间。
    - 遍历每台机器：
        - 总任务时间加上当前机器的配置时间。
        - 如果还需等待的执行时间小于当前机器的配置时间，则等于当前机器的执行时间。
        - 如果执行时间还有，则减去当前机器的配置时间，并加上当前机器的执行时间。
    - 最后总任务时间再加上等待的执行时间。
    - 将总任务时间存入结果列表中。
2. 返回结果。

## 解题代码

```python
def solve_method(tasks):
    result = []
    for task in tasks:
        N = len(task)
        # 按照运行时间从大到小排列
        jobs = sorted(task, key=lambda x: x[1], reverse=True)

        # 总任务时间
        time = 0
        # 还需要等待的执行时间
        remaining = 0
        for job in jobs:
            # 累加配置时间
            time += job[0]
            if remaining <= 0:
                # 如果还需等待的执行时间小于当前机器的配置时间，则等于当前机器的执行时间
                remaining = job[1]
            else:
                # 如果执行时间还有，则减去当前机器的配置时间，并加上当前机器的执行时间
                remaining -= job[0]
                remaining += job[1]

        # 最后再加上等待的执行时间
        time += remaining
        result.append(time)

    return result


if __name__ == '__main__':
    tasks = [[(2, 2)]]
    assert solve_method(tasks) == [4]

    tasks = [[(1, 1), (2, 2)],
             [(1, 1), (2, 2), (3, 3)]]
    assert solve_method(tasks) == [5, 9]
```