# 012 区块链文件转储系统

## 题目描述

区块链底层存储是一个链式文件系统，由顺序的`N`个文件组成，每个文件的大小不一，依次为`[F1,F2,...,Fn]`。随着时间的推移，所占存储会越来越大。云平台考虑将区块链按文件转储到廉价的SATA盘，只有连续的区块链文件才能转储到SATA盘上，且转储的文件之和不能超过SATA盘的容量。

假设每块SATA盘容量为`M`，求能转储的最大连续文件大小之和。

## 输入描述s

第一行是SATA盘容量`M`，取值范围是1000 <= M <= 1000000。

第二行是区块链文件大小序列`[F1,F2,...,Fn]`。其中1 <= n <= 100000、1 <= F[i] <= 500。

## 输出描述

求能转储的最大连续文件大小之和。

## 示例描述

### 示例一

**输入：**
```text
1000
100 300 500 400 400 150 100
```

**输出：**
```text
950
```

**说明：** 

最大序列和为950，序列为`[400,400,150]`。

### 示例二

**输入：**
```text
1000
100 500 400 150 500 100
```

**输出：**
```text
1000
```

**说明：** 
最大序列和为1000，序列为`[100,500,400]`。

## 解题思路

**基本思路：** 使用双指针方法求解。

1. 初始化左右指针，分别为`l`和`r`。
2. 初始化子文件集的大小之和`sum_val`、最大子文件大小之和`max_val`。
3. 遍历所有文件：
   - 计算新的子文件集大小之和`new_sum`。
   - 如果子文件集大小之和超过了容量，则删除最左边的文件，左指针向左移。
   - 如果子文件集大小之和小于容量，则添加该文件，右指针向右移，比较并得到文件集的最大容量。
   - 如果相等，则返回最大容量为M。
4. 返回结果，即最大子文件大小之和。    

## 解题代码

```python
def solve_method(M, files):
    l, r = 0, 0
    sum_val, max_val = 0, 0
    while r < len(files):
        # 计算新的子文件集大小之和
        new_sum = sum_val + files[r]
        if new_sum > M:
            # 如果子文件集大小之和超过了容量，则删除最左边的文件，左指针向左移
            sum_val -= files[l]
            l += 1
        elif new_sum < M:
            # 如果子文件集大小之和小于容量，则添加该文件，右指针向右移
            sum_val += files[r]
            r += 1
            # 比较并得到文件集的最大容量
            max_val = max(sum_val, max_val)
        else:
            # 如果相等，则得到最大容量为M
            return M

    return max_val


if __name__ == '__main__':
    file_sizes = [100, 300, 500, 400, 400, 150, 100]
    assert solve_method(1000, file_sizes) == 950

    file_sizes = [100, 500, 400, 150, 500, 100]
    assert solve_method(1000, file_sizes) == 1000

    file_sizes = [100, 100, 500, 500, 100, 100]
    assert solve_method(1000, file_sizes) == 1000
```